{% extends "base.html" %}
{% block title %}MoonLight ‚Äî –°–æ–∑–¥–∞—Ç—å —Å–æ–±—Ä–∞–Ω–∏–µ{% endblock %}
{% block page_title %}–°–æ–∑–¥–∞—Ç—å —Å–æ–±—Ä–∞–Ω–∏–µ{% endblock %}

{% block topbar_actions %}
<a href="/meetings" class="btn btn-ghost btn-sm">‚Üê –ù–∞–∑–∞–¥</a>
{% endblock %}

{% block content %}

<div style="max-width:600px">
    <div class="card">
        <form method="POST" action="/meetings/create">
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–∏—è *</label>
                <input name="title" class="form-input" placeholder="–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ" required>
            </div>

            <div class="form-group">
                <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea name="description" class="form-input" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–≤–µ—Å—Ç–∫–∏..." rows="3"></textarea>
            </div>

            <div class="form-group">
                <label class="form-label">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è *</label>
                <input type="datetime-local" name="scheduled_at" class="form-input" required id="dt-input">
            </div>

            <div class="form-group">
                <label class="form-label">ID –∫–∞–Ω–∞–ª–∞ Discord –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label>
                <input name="notify_channel" class="form-input" placeholder="1234567890123456789" pattern="[0-9]*">
                <div style="font-size:11px;color:var(--text3);margin-top:6px">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º —á—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Discord</div>
            </div>

            <div class="form-group">
                <label class="form-label">ID –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –∫–∞–Ω–∞–ª–∞ (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)</label>
                <input type="text" name="voice_channel_id" class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 123456789012345678">
                <div style="font-size:11px;color:var(--text3);margin-top:4px">–ë–æ—Ç –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫—Ç–æ –∑–∞—Ö–æ–¥–∏—Ç/–≤—ã—Ö–æ–¥–∏—Ç</div>
            </div>

            <div style="display:flex;gap:10px;margin-top:8px">
                <button type="submit" class="btn btn-primary">üìÖ –°–æ–∑–¥–∞—Ç—å —Å–æ–±—Ä–∞–Ω–∏–µ</button>
                <a href="/meetings" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>
    </div>

    <!-- Preview -->
    <div class="card" style="margin-top:20px;border-color:rgba(79,142,247,.2)">
        <div class="card-title" style="margin-bottom:16px">üëÅ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä Discord —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
        <div style="background:#2f3136;border-radius:8px;padding:16px;border-left:4px solid #5865F2">
            <div style="color:#fff;font-weight:700;font-size:15px;margin-bottom:6px">üìÖ –ù–æ–≤–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ: <span id="prev-title">‚Äî</span></div>
            <div style="color:#dcddde;font-size:14px;margin-bottom:10px" id="prev-desc"></div>
            <div style="display:flex;gap:24px">
                <div>
                    <div style="color:#b9bbbe;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px">üïê –í—Ä–µ–º—è</div>
                    <div style="color:#dcddde;font-size:14px" id="prev-time">‚Äî</div>
                </div>
                <div>
                    <div style="color:#b9bbbe;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px">üë§ –°–æ–∑–¥–∞–ª</div>
                    <div style="color:#dcddde;font-size:14px">{{ user.username }}</div>
                </div>
            </div>
            <div style="color:#72767d;font-size:11px;margin-top:10px">MoonLight ‚Ä¢ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É—á–∞—Å—Ç–∏—è</div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
// Set default datetime to now + 1 day
const now = new Date();
now.setDate(now.getDate() + 1);
now.setMinutes(0, 0, 0);
document.getElementById('dt-input').value = now.toISOString().slice(0, 16);
updatePreview();

document.querySelector('[name=title]').addEventListener('input', updatePreview);
document.querySelector('[name=description]').addEventListener('input', updatePreview);
document.getElementById('dt-input').addEventListener('input', updatePreview);

function updatePreview() {
    const title = document.querySelector('[name=title]').value || '‚Äî';
    const desc = document.querySelector('[name=description]').value || '';
    const dt = document.getElementById('dt-input').value;

    document.getElementById('prev-title').textContent = title;
    document.getElementById('prev-desc').textContent = desc;

    if (dt) {
        const d = new Date(dt);
        document.getElementById('prev-time').textContent = d.toLocaleString('ru-RU', {
            day: '2-digit', month: '2-digit', year: 'numeric',
            hour: '2-digit', minute: '2-digit'
        });
    }
}
</script>
{% endblock %}
